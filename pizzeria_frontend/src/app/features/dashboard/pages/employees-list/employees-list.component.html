<div class="container">
    <h1>Empleados</h1>
      <button type="button" class="btn btn-success bi     bi-plus" data-bs-toggle="modal" data-bs-target="#addEmployee"
    data-bs-whatever="@mdo">Agregar
      </button>
      <br>
      <br>

    <table *ngIf="employeeItems.length >= 1" class="table table-striped">
        <thead>
          <tr>
            <th>id</th>
            <th>Nombre completo</th>
            <th>correo</th>
            <!-- <th>contraseña</th> -->
            <th>Acciones</th>

          </tr>
        </thead>
        <tbody>

          <tr *ngFor="let item of paginatedData;">
            <td>{{item.id_employees}}</td>
            <td>{{item.full_name}}</td>
            <td>{{item.email}}</td>
            <!-- <td>{{item.password}}</td> -->

            <section>
              <div class="example-button-row">
                <div class="example-flex-container">
                  <div class="example-button-container">
                    <td>

                      <button type="button" class="btn btn-danger" data-bs-toggle="modal" data-bs-target="#showConfirmateDelete" (click)="setIdForDelete(item.id_employees)">
                        <i class="bi bi-trash"></i>
                      </button>

                      <span> | </span>

                      <button type="button" class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#editEmployee" (click)="setIdUpdate(item.id_employees, item)">
                        <i class="bi bi-pencil"></i>
                      </button>
                      
                    </td>
                  </div>
                </div>
              </div>
            </section>
          </tr>
        </tbody>
      </table>

      <div *ngIf="employeeItems.length === 0">
        <p class="text-center text-gray-600 dark:text-gray-600 mt-4">
          No hay datos de Excel para mostrar o el archivo está vacío.
        </p>
      </div>

     <nav aria-label="Page navigation example" *ngIf="totalPages > 1" class="d-flex justify-content-center mt-4">
  <ul class="pagination">
    <li class="page-item" [class.disabled]="currentPage === 1">
      <a class="page-link" href="javascript:void(0)" (click)="goToPage(currentPage - 1)">Atrás</a>
    </li>
    <li
      class="page-item"
      *ngFor="let page of getPages()"
      [class.active]="page === currentPage"
    >
      <a class="page-link" href="javascript:void(0)" (click)="goToPage(page)">
        {{ page }}
      </a>
    </li>
    <li class="page-item" [class.disabled]="currentPage === totalPages">
      <a class="page-link" href="javascript:void(0)" (click)="goToPage(currentPage + 1)">Siguiente</a>
    </li>
  </ul>
</nav>
      
      <div class="text-center text-sm text-gray-600 dark:text-gray-600 mt-2" *ngIf="paginatedData.length > 0">
        Mostrando {{ (currentPage - 1) * itemsPerPage + 1 }} - {{ (currentPage - 1) * itemsPerPage + paginatedData.length
        }} de {{ totalItems }} registros.
      </div>
  
</div>

<!-- Toast de éxito o error -->
<div id="toastMessage" class="toast position-fixed bottom-0 end-0 p-3" role="alert" aria-live="assertive" aria-atomic="true" [ngClass]="{'show': errorMessage}">
  <div class="toast-header" [ngClass]="{'bg-danger': errorMessage}">
    <img src="assets/ic_notification.png" class="rounded me-2" alt="..." width="30" height="30">
    <strong class="me-auto" [ngClass]="{'text-light': errorMessage}">Mensaje del sistema</strong>
    <button type="button" class="btn-close" data-bs-dismiss="toast" aria-label="Close"></button>
  </div>
  <div class="toast-body">
    {{ errorMessage }}
  </div>
</div>

<!-- Modal de confirmación de eliminación -->
<div class="modal fade" id="showConfirmateDelete" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1" aria-labelledby="staticBackdropLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header bg-danger">
        <h2 class="modal-title text-center text-light" id="staticBackdropLabel">Confirmar Eliminación</h2>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        <h2 class="text-center">
          <img src="assets/ic_warning.png" width="50" height="50">
          <br>
          ¿Estas seguro que deseas eliminarlo?
        </h2>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-danger" data-bs-dismiss="modal">Cerrar</button>
        <button type="button" class="btn btn-success" (click)="deleteEmployee()">Aceptar</button>
      </div>
    </div>
  </div>
</div>

 <!-- Formulario desplegable para crear usuario -->
 <div class="modal fade" id="addEmployee" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h1 class="modal-title" id="exampleModalLabel">Crear nuevo empleado</h1>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">

        <form (ngSubmit)="employeeAdd()">
          <div class="mb-3">
            <label class="form-label">Nombre del empleado:</label>
            <input type="text" class="form-control" [(ngModel)]="employeeData.full_name" name="full_name" id="full_name" placeholder="Escriba un nombre">
          </div>

          <div class="mb-3">
            <label class="form-label">Correo electronico:</label>
            <input type="text" class="form-control" [(ngModel)]="employeeData.email" name="email" id="email" placeholder="Escriba su Correo">
          </div>

          <div class="row g-3 align-items-center">
            <div class="col-auto">
              <label for="inputPassword6" class="col-form-label">Contraseña</label>
            </div>
            <div class="col-auto">
              <input type="password" [(ngModel)]="employeeData.password" name="password" id="password"  class="form-control" aria-describedby="passwordHelpInline">
            </div>
            <div class="col-auto">
              <span id="passwordHelpInline" class="form-text">
                debe de ser mayor a 5 y menos a 12 caracteres
              </span>
            </div>
          </div>

        </form>

        <button type="submit" class="btn btn-success" (click)="employeeAdd()">Crear</button>
        <span> | </span>
        <button type="button" class="btn btn-danger" (click)="clearForm()" data-bs-dismiss="modal">Cancelar</button>
      </div>
    </div>
  </div>
</div>
 <!-- Formulario desplegable para editar -->
 <div class="modal fade" id="editEmployee" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h1 class="modal-title text-center" id="exampleModalLabel">Editar empleado</h1>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">

        <form (ngSubmit)="employeeAdd()">
          <div class="mb-3">
            <label class="form-label">ID</label>
            <input type="number" class="form-control" readonly [(ngModel)]="employeeUpData.id_employees" name="id" id="id">
          </div>
          <div class="mb-3">
            <label class="form-label">Nombre del empleado:</label>
            <input type="text" class="form-control" [(ngModel)]="employeeUpData.full_name" name="full_name" id="full_name" placeholder="Escriba un nombre">
          </div>

          <div class="mb-3">
            <label class="form-label">Correo electronico:</label>
            <input type="text" class="form-control" [(ngModel)]="employeeUpData.email" name="email" id="email" placeholder="Escriba su Correo">
          </div>

          <div class="row g-3 align-items-center">
            <div class="col-auto">
              <label for="inputPassword6" class="col-form-label">Contraseña</label>
            </div>
            <div class="col-auto">
              <input type="password" [(ngModel)]="employeeUpData.password" readonly name="password" id="password"  class="form-control" aria-describedby="passwordHelpInline">
            </div>
            <div class="col-auto">
              
            </div>
          </div>

        </form>

        <button type="submit" class="btn btn-success" (click)="updateEmployee()">Editar</button>
        <span> | </span>
        <button type="button" class="btn btn-danger" data-bs-dismiss="modal">Cancelar</button>
      </div>
    </div>
  </div>
</div>

<router-outlet />
